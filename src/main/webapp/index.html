<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Type-Level Programming | The Subspace of Scala | by Joe Barnes @joescii</title>
    
    <meta name="description" content="." />
    <meta name="author" content="Joe Barnes" />

    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />

    <link href="css/type-prog.css" rel="stylesheet" />
 
    <link rel="shortcut icon" href="favicon.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />
</head>

<body class="impress-not-supported">

<div class="fallback-message">
    <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
</div>

<div id="impress">

  <div id="title" class="step" data-x="-2000" data-bg="sc-none">
    <h1>Type-Level Programming</h1>
    <h2>The Subspace of Scala</h2>
    <h2>Follow along at http://<span data-lift="Host">localhost</span>:8080</h2>
  </div>

  <div id="joe-barnes" class="step" data-x="-725" data-y="150" data-bg="sc-none">
    <div class="name">
      <h1>Joe Barnes</h1>
      <h2><i><a href="https://twitter.com/joescii">@joescii</a></i></h2>
      <h2><i><a href="http://proseand.co.nz">prose :: and :: conz</a> </i></h2>
      <h2><i><a href="https://github.com/joescii/type-prog-impress">Presentation Source</a> </i></h2>
    </div>
    <ul>
      <li>CS and Math degrees</li>
      <li>Primarily Java from 2004-2013</li>
      <li>Started Scala late 2012</li>
      <li>Started Scala at Mentor Graphics late 2013</li>
      <li>Lift committer in July 2014</li>
    </ul>
  </div>

  <div id="so-type-prog" class="step" data-x="-725" data-y="1000" data-bg="sc-none">
    <div>So... Type programming...</div>
    <div>What do <em>you</em> know about <em>that</em>, Joe??</div>
  </div>

  <div id="not-much" class="step" data-x="-2000" data-y="1000" data-bg="sc-none">
    <div>Not much...</div>
  </div>

  <div id="shapeless-contributions" class="step" data-x="-3000" data-y="1000" data-bg="sc-none">
    <div>I've made zero contributions to shapeless</div>
  </div>

  <div id="cats-contributions" class="step" data-x="-3000" data-y="2000" data-bg="sc-none">
    <div>Also no contributions to Cats</div>
    <img src="/imgs/cats.png">
  </div>

  <div id="cat-memes" class="step" data-x="-2500" data-y="1000" data-z="2000" data-bg="sc-none">
    <div>Although I have contributed plenty of cat memes!</div>
    <img class="appear1" src="/imgs/cat-meme1.jpg">
    <img class="appear2" src="/imgs/cat-meme2.jpg">
    <img class="appear3" src="/imgs/cat-meme3.jpg">
    <img class="appear4" src="/imgs/cat-meme4.jpg">
    <img class="appear5" src="/imgs/cat-meme5.jpg">
    <img class="appear6" src="/imgs/cat-meme6.jpg">
    <img class="appear7" src="/imgs/cat-meme7.jpg">
  </div>

  <div id="aha" class="step" data-x="-3500" data-y="150" data-bg="sc-none">
    <div>I'm not here to share expertise on the subject,</div>
    <div>but rather my <em>Aha!</em> moment.</div>
  </div>

  <div id="mario2-cover" class="step mario" data-x="700" data-bg="sc-none">
    <img src="imgs/cover-art.jpg">
  </div>

  <div id="mario2" class="step mario" data-x="2200" data-bg="sc-none">
    <img src="imgs/Mario2.png">
    <span>Normal value programming</span>
  </div>

  <div id="potion" class="step mario" data-x="3700" data-bg="sc-none">
    <img src="imgs/Potion.png">
    <span>A flask of type programming!</span>
  </div>

  <div id="door" class="step mario" data-x="5200" data-bg="sc-none">
    <img src="imgs/Door.png">
    <span>Where does this go?</span>
  </div>

  <div id="in-subspace" class="step mario" data-x="5200" data-z="-200" data-rotate-y="180" data-bg="ss-none">
    <img src="imgs/Subcon.png">
    <span>SUBSPACE!</span>
  </div>

  <div id="val" class="step" data-x="2000"  data-y="-3000" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
      val num = 1 + 2 + 3
    </div></code></pre>
  </div>

  <div id="lazy-val" class="step" data-x="2000" data-y="-2666" data-z="500" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
      lazy val str = "a"+"b"+"c"
    </div></code></pre>
  </div>

  <div id="def" class="step" data-x="2000" data-y="-2333" data-z="1000" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
      def now = new java.util.Date
    </div></code></pre>
  </div>

  <div id="type" class="step" data-x="2000" data-y="-2000" data-z="1500" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
      type MyMap = Map[Int, String]
    </div></code></pre>
  </div>

  <div id="lets-compare" class="step" data-x="2000" data-y="-1000" data-z="1500" data-bg="sc">
    <div>Let's compare values to types with the simplest domain ever</div>
  </div>

  <div id="boolval" class="step" data-x="1000" data-y="1000" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
sealed trait BoolVal
case object TrueVal extends BoolVal
case object FalseVal extends BoolVal
    </div></code></pre>
  </div>

  <div id="boolval-or-not" class="step" data-x="1000" data-y="2000" data-z="500" data-rotate-y="45" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
sealed trait BoolVal {
  def not:BoolVal
  def or(that:BoolVal):BoolVal
}
    </div></code></pre>
  </div>

  <div id="trueval-or-not" class="step" data-x="1000" data-y="3000" data-z="0" data-rotate-y="90" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
case object TrueVal extends BoolVal {
  override val not = FalseVal
  override def or(that:BoolVal) =
    TrueVal
}
    </div></code></pre>
  </div>

  <div id="falseval-or-not" class="step" data-x="1000" data-y="4000" data-z="500" data-rotate-y="135" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
case object FalseVal extends BoolVal {
  override val not = TrueVal
  override def or(that:BoolVal) = that
}
    </div></code> </pre>
  </div>

  <div id="booltype" class="step" data-x="2300" data-y="1000" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait BoolType
sealed trait TrueType extends BoolType
sealed trait FalseType extends BoolType
    </div></code></pre>
  </div>

  <div id="bool-compare" class="step" data-x="1600" data-y="1000" data-scale="1.3" data-bg="sc">

  </div>

  <div id="booltype-or-not" class="step" data-x="1750" data-y="2000" data-z="-250" data-rotate-y="45" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait BoolType {
  type Not &lt;: BoolType
  type Or[That &lt;: BoolType] &lt;: BoolType
}
    </div></code></pre>
  </div>

  <div id="or-not-compare" class="step" data-x="1500" data-y="2000" data-z="250" data-rotate-y="45" data-scale="1.3" data-bg="sc">

  </div>

  <div id="truetype-or-not" class="step" data-x="1000" data-y="3000" data-z="-1000" data-rotate-y="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait TrueType extends BoolType {
  override type Not = FalseType
  override type Or[That &lt;: BoolType] =
    TrueType
}
    </div></code></pre>
  </div>

  <div id="true-compare" class="step" data-x="1000" data-y="3000" data-z="-500" data-rotate-y="90" data-scale="1.3" data-bg="sc">

  </div>

  <!--<div id="falseval-or-not" class="step" data-x="1000" data-y="4000" data-z="500" data-rotate-y="135" data-bg="sc">-->
  <div id="falsetype-or-not" class="step" data-x="150" data-y="4000" data-z="-500" data-rotate-y="135" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait FalseType extends BoolType {
  override type Not = TrueType
  override type Or[That &lt;: BoolType] = That
}
    </div></code> </pre>
  </div>

  <div id="false-compare" class="step" data-x="575" data-y="4000" data-z="0" data-rotate-y="135" data-scale="1.3" data-bg="sc">

  </div>

  <div id="test-bool" class="step" data-x="2000" data-y="5000" data-z="1400" data-rotate-y="180" data-bg="sc">
    But how can we test our BoolType??
  </div>

  <div id="bool-type-specs1" class="step" data-x="1000" data-y="5000" data-z="2400" data-rotate-y="180" data-rotate="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
// Compile to test
object BoolTypeSpecs {
  implicitly[TrueType  =:= TrueType]
  implicitly[FalseType =:= FalseType]
}
    </div></code></pre>
  </div>

  <div id="negative-cases" class="step" data-x="2000" data-y="4000" data-z="2400" data-rotate-y="180" data-rotate="180" data-bg="sc">
    Ok, but what about negative test cases??
  </div>

  <div id="bool-type-specs2" class="step" data-x="4500" data-y="4000" data-z="2400" data-rotate-y="180" data-rotate="180" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
import shapeless.test.illTyped
// Compiles only if string DOESN'T compile
illTyped("implicitly[TrueType  =:= FalseType]")
illTyped("implicitly[FalseType =:= TrueType]")
    </div></code></pre>
  </div>

  <div id="bool-type-specs3" class="step" data-x="4500" data-y="3000" data-z="2400" data-rotate-y="180" data-rotate="180" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
implicitly[TrueType#Not  =:= FalseType]
implicitly[FalseType#Not =:= TrueType]
illTyped("implicitly[TrueType#Not  =:= TrueType]")
illTyped("implicitly[FalseType#Not =:= FalseType]")
    </div></code></pre>
  </div>

  <div id="bool-type-specs4" class="step" data-x="4500" data-y="2000" data-z="2400" data-rotate-y="180" data-rotate="180" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
implicitly[TrueType#Or[TrueType] =:= TrueType]
implicitly[TrueType#Or[FalseType] =:= TrueType]
implicitly[FalseType#Or[TrueType] =:= TrueType]
implicitly[FalseType#Or[FalseType] =:= FalseType]
    </div></code></pre>
  </div>

  <div id="just-two-types" class="step" data-x="4500" data-y="1500" data-z="2400" data-bg="sc">
    Well that was easy... It's just two types, really...
  </div>

  <div id="IntVal" class="step" data-x="4500" data-y="2500" data-z="2400" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
sealed trait IntVal {
  def plus(that:IntVal):IntVal
}
case object Int0 extends IntVal {
  override def plus(that:IntVal) = that
}
case class IntN(prev:IntVal) extends IntVal {
  override def plus(that:IntVal) =
    IntN(prev plus that)
}
    </div></code> </pre>
  </div>

  <div id="IntVal-usage" class="step" data-x="4500" data-y="3500" data-z="2400" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
val int1 = IntN(Int0)
val int2 = IntN(int1)
val int3 = IntN(int2)

Int0 should equal (Int0)
Int0 should not equal (int1)

(Int0 plus int1) should equal (int1)
(int1 plus int1) should equal (int2)
(int1 plus int2) should equal (int3)
    </div></code> </pre>
  </div>

  <div id="IntType" class="step" data-x="6000" data-y="2500" data-z="2400" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait IntType {
  type plus[That &lt;: IntType] &lt;: IntType
}
sealed trait Int0 extends IntType {
  override type plus[That &lt;: IntType] = That
}
sealed trait IntN[Prev &lt;: IntType] extends IntType {
  override type plus[That &lt;: IntType] =
    IntN[Prev#plus[That]]
}
    </div> </code> </pre>
  </div>

  <div id="IntType-tests" class="step" data-x="6000" data-y="4000" data-z="2400" data-rotate="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
type Int1 = IntN[Int0]
type Int2 = IntN[Int1]
type Int3 = IntN[Int2]

implicitly[Int0 =:= Int0]
illTyped("implicitly[Int0 =:= Int1]")

implicitly[Int0#plus[Int1] =:= Int1]
implicitly[Int1#plus[Int1] =:= Int2]
implicitly[Int1#plus[Int2] =:= Int3]

    </div> </code> </pre>
  </div>

  <div id="blah-blah" class="step" data-x="5000" data-y="4000" data-z="2400" data-rotate="90" data-bg="sc">
    <div class="">
      Types, types, and more types, blah, blah, blah.
      What good is it??
    </div>
  </div>

  <div id="unsafe-IntList" class="step" data-x="7000" data-y="2500" data-z="2400" data-rotate-y="-90" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
sealed trait IntList {
  def size:Int
}
case object IntNil extends IntList {
  override val size = 0
}
case class IntListImpl(head:Int, tail:IntList)
extends IntList {
  override val size = 1 + tail.size
}
    </div> </code> </pre>
  </div>

  <div id="unsafe-IntList-def-sum" class="step" data-x="7000" data-y="3500" data-z="2400" data-rotate-y="-90" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
sealed trait IntList {
  // Convenience list constructor
  def ::(head:Int):IntList = IntListImpl(head, this)
  // Vector addition
  def +(that:IntList):IntList
  def size:Int
}
    </div> </code> </pre>
  </div>

  <div id="unsafe-IntList-specs" class="step" data-x="7000" data-y="4500" data-z="2400" data-rotate-y="-90" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
val sum = (1 :: 2 :: IntNil) + (3 :: 4 :: IntNil)
sum should equal (4 :: 6 :: IntNil)

intercept[IllegalArgumentException](
  (1 :: 2 :: IntNil) + (5 :: IntNil)
)
    </div> </code> </pre>
  </div>

  <div id="unsafe-IntNil" class="step" data-x="7000" data-y="5500" data-z="2400" data-rotate-y="-90" data-bg="sc">
    <pre><code class="scala light"><div class="centered">
case object IntNil extends IntList {
  override def +(that:IntList) = {
    require(that == IntNil)
    this
  }
  override val size = 0
}
    </div> </code></pre>
  </div>

  <div id="unsafe-IntListImpl" class="step" data-x="7000" data-y="6500" data-z="2400" data-rotate-y="-90" data-bg="sc">
    <pre><code class="scala light"><div class="">
case class IntListImpl(head:Int, tail:IntList)
extends IntList {
  override def +(that:IntList) = {
    require(that.size == size)
    that match {
      case IntListImpl(h, t) => (head + h) :: (tail + t)
    }
  }
  override val size = 1 + tail.size
}
    </div> </code></pre>
  </div>

  <div id="when" class="step" data-x="7000" data-y="7500" data-z="2400" data-rotate-y="-90" data-rotate="-90" data-bg="sc">
    This implementation validates size at runtime. But <i>when</i> do we know the size?
  </div>

  <div id="compile-time" class="step dark" data-x="7000" data-y="7500" data-z="3000" data-rotate-y="90" data-rotate="-90" data-bg="ss">
    Compile time! (The lists are immutable)
  </div>

  <div id="IntList" class="step" data-x="7000" data-y="2500" data-z="3700" data-rotate-y="-90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait IntList[Size &lt;: IntType]
case object IntNil extends IntList[Int0]
case class IntListImpl[TailSize &lt;: IntType]
  (head:Int, tail:IntList) extends IntList
    </div> </code> </pre>
  </div>

  <!--<div id="IntList-compare" class="step" data-x="7000" data-y="2500" data-z="3000" data-rotate-y="-90" data-scale="1.3" data-bg="sc">-->

  <!--</div>-->

  <div id="IntList-def-sum" class="step" data-x="7000" data-y="3500" data-z="3700" data-rotate-y="-90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait IntList[Size &lt;: IntType] {
  def ::(head:Int):IntList[IntN[Size]] =
    IntListImpl(head, this)
  def +(that:IntList[Size]):IntList[Size]
}
    </div> </code> </pre>
  </div>

  <div id="IntList-specs" class="step" data-x="7000" data-y="4500" data-z="3700" data-rotate-y="-90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
val sum = (1 :: 2 :: IntNil) + (3 :: 4 :: IntNil)
sum should equal (4 :: 6 :: IntNil)

// Screw IllegalArgument Exception.
// This crap won't even compile!
illTyped("(1 :: 2 :: IntNil) + (5 :: IntNil)")
    </div> </code> </pre>
  </div>

  <div id="IntNil-sum" class="step" data-x="7000" data-y="5500" data-z="3700" data-rotate-y="-90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
case object IntNil extends IntList[Int0] {
  override def +(that:IntList[Int0]) = this
}
    </div> </code> </pre>
  </div>

  <div id="IntList-sum-compare" class="step" data-x="7000" data-y="5500" data-z="3000" data-rotate-y="-90" data-scale="1.3" data-bg="sc">

  </div>

  <div id="IntListImpl-sum" class="step" data-x="7000" data-y="6500" data-z="3700" data-rotate-y="-90" data-bg="ss">
    <pre><code class="scala dark"><div class="">
case class IntListImpl[TailSize &lt;: IntType]
  (head:Int, tail:IntList[TailSize])
extends IntList[IntN[TailSize]] {
  override def +(that:IntList[IntN[TailSize]]) = that match {
    case IntListImpl(h, t) => (head + h) :: (tail + t)
  }
}
    </div> </code> </pre>
  </div>

  <div id="IntList-def-concat" class="step" data-x="7000" data-y="6500" data-z="5500" data-rotate-y="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
sealed trait IntList[Size &lt;: SizeType] {
  def ++[ThatSize &lt;: SizeType]
    (that:IntList[ThatSize])
    :IntList[Size#plus[ThatSize]]
}
    </div> </code> </pre>
  </div>

  <div id="IntNil-concat" class="step" data-x="7000" data-y="5500" data-z="5500" data-rotate-y="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
case object IntNil extends IntList[Size0] {
  override def ++[ThatSize &lt;: SizeType]
    (that:IntList[ThatSize]) = that
}
    </div> </code> </pre>
  </div>

  <div id="IntListImpl-concat" class="step" data-x="7000" data-y="5500" data-z="7000" data-rotate-y="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
case class IntListImpl[TailSize &lt: IntType]
  (head:Int, tail:IntList[TailSize])
extends IntList[IntN[TailSize]] {

  override def ++[ThatSize &lt;: SizeType]
    (that:IntList[ThatSize]) =
    IntListImpl(head, tail++that)
}
    </div> </code> </pre>
  </div>

  <div id="IntList-concat-specs" class="step" data-x="7000" data-y="4500" data-z="7000" data-rotate-y="90" data-bg="ss">
    <pre><code class="scala dark"><div class="centered">
val sum =
  ((1 :: 2 :: IntNil) ++ (3 :: IntNil)) +
  (4 :: 5 :: 6 :: IntNil)
sum should equal (5 :: 7 :: 9 :: IntNil)
    </div> </code> </pre>
  </div>

  <div id="retro" class="step" data-x="7000" data-y="3500" data-z="" data-bg="sc">
    <h1>Retrospective</h1>
  </div>

  <div id="retro1" class="step" data-x="6000" data-y="3500" data-z="" data-rotate="90" data-bg="sc">
    <p>Types are not just the shape of my objects</p>
  </div>

  <div id="retro2" class="step" data-x="5000" data-y="3500" data-z="" data-rotate="180" data-bg="sc">
    <p>Type programming expedites computation to compile time</p>
  </div>

  <div id="retro3" class="step" data-x="5000" data-y="4500" data-z="" data-rotate="90" data-bg="sc">
    <p>This guarantees I see the errors, rather than my users</p>
  </div>

  <div id="retro4" class="step" data-x="6500" data-y="4500" data-z="" data-rotate="" data-bg="sc">
    <p>Type validations propagate through my code base</p>
  </div>

  <div id="questions" class="step" data-x="7000" data-y="4500" data-z="2000" data-bg="sc">
    Questions?
  </div>

  <div id="comments" class="step" data-x="6875" data-y="4750" data-z="2125" data-bg="sc">
    Comments?
  </div>

  <div id="concerns" class="step" data-x="6750" data-y="4500" data-z="2250" data-bg="sc">
    Concerns?
  </div>
</div>
<div data-lift="Host.ifNotLocal"><div data-lift="embed?what=slide-controls"></div></div>

  <!--

      So to make a summary of all the possible attributes used to position presentation steps, we have:

      * `data-x`, `data-y`, `data-z` - they define the position of **the center** of step element on
          the canvas in pixels; their default value is 0;
      * `data-rotate-x`, `data-rotate-y`, 'data-rotate-z`, `data-rotate` - they define the rotation of
          the element around given axis in degrees; their default value is 0; `data-rotate` and `data-rotate-z`
          are exactly the same;
      * `data-scale` - defines the scale of step element; default value is 1

      These values are used by impress.js in CSS transformation functions, so for more information consult
      CSS transfrom docs: https://developer.mozilla.org/en/CSS/transform

  -->
    <!--<div id="overview" class="step" data-x="3000" data-y="1500" data-scale="10">-->
    <!--</div>-->


<div data-lift="Host.ifLocal">
<div class="hint">
    <p>Use a spacebar or arrow keys to navigate</p>
</div>
<script>
if ("ontouchstart" in document.documentElement) { 
    document.querySelector(".hint").innerHTML = "<p>Tap on the left or right to navigate</p>";
}
</script>
</div>

<script src="js/highlight.min.js"></script>
<script src="js/scala.min.js"></script>
<script id="jquery" src="/classpath/jquery.js" type="text/javascript"></script>
<script src="js/impress.js"></script>
<div data-lift="Host.ifNotLocal">
  <div data-lift="comet?type=PresentationComet"></div>
  <div data-lift="PresentationState"></div>
</div>
<script data-lift="Host.ifNotLocal" src="js/impress-client.js"></script>
<script data-lift="Presenter"></script>
<script data-lift="Host.ifLocal" src="js/impress-presenter.js"></script>
<script>impress().init();hljs.initHighlightingOnLoad();</script>

</body>
</html>

